// Test output.
void testPrint(const char * const str, ...);

class ExampleClass(int i) {
	static Create(int i) {
		testPrint("ExampleClass Constructor: %d.", i);
		return @(i);
	}
	
	~ {
		testPrint("ExampleClass Destructor: %d.", @i);
	}
}

exception ExampleError(long value);
exception ExampleError2(long value);

void throwFunction(bool throwFirst) {
	auto value1 = ExampleClass(1);
	auto value2 = ExampleClass(2);
	
	try {
		auto value3 = ExampleClass(3);
		if (throwFirst) {
			throw ExampleError(424242);
		} else {
			throw ExampleError2(212121);
		}
	} catch (ExampleError2 error) {
		testPrint("Caught exception V2 with value %ld!", error.value);
	}
}

// Entry point.
int testEntryPoint(int argc, char ** argv) {
	testPrint("Started.");
	try {
		auto value0 = ExampleClass(0);
		throwFunction(false);
		throwFunction(true);
	} catch (ExampleError error) {
		auto value4 = ExampleClass(4);
		testPrint("Caught exception with value %ld!", error.value);
	}
	testPrint("Finished.");
	return 0;
}

